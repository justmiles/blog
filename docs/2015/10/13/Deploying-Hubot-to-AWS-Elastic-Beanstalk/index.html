<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Deploying Hubot to AWS Elastic Beanstalk | My Inner Daemons</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="If you haven’t already embraced the ChatOps methodology it’s time to seriously consider it. Coining the term, the folks over at Github describe it as “putting tools in the middle of the conversation”.">
<meta property="og:type" content="article">
<meta property="og:title" content="Deploying Hubot to AWS Elastic Beanstalk">
<meta property="og:url" content="http://blog.milesmaddox.com/2015/10/13/Deploying-Hubot-to-AWS-Elastic-Beanstalk/index.html">
<meta property="og:site_name" content="My Inner Daemons">
<meta property="og:description" content="If you haven’t already embraced the ChatOps methodology it’s time to seriously consider it. Coining the term, the folks over at Github describe it as “putting tools in the middle of the conversation”.">
<meta property="og:updated_time" content="2016-11-01T14:31:03.252Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Deploying Hubot to AWS Elastic Beanstalk">
<meta name="twitter:description" content="If you haven’t already embraced the ChatOps methodology it’s time to seriously consider it. Coining the term, the folks over at Github describe it as “putting tools in the middle of the conversation”.">
  
    <link rel="alternative" href="/atom.xml" title="My Inner Daemons" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/css/style.css">
  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-68541029-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


</head>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <div id="logo-wrap"></div>
      <a href="/" id="logo">My Inner Daemons</a>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">Notes from an SRE</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">home</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://blog.milesmaddox.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-Deploying-Hubot-to-AWS-Elastic-Beanstalk" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/10/13/Deploying-Hubot-to-AWS-Elastic-Beanstalk/" class="article-date">
  <time datetime="2015-10-13T05:00:00.000Z" itemprop="datePublished">2015-10-13</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/walkthrough/">walkthrough</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Deploying Hubot to AWS Elastic Beanstalk
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>If you haven’t already embraced the ChatOps methodology it’s time to seriously consider it. Coining the term, the folks over at Github describe it as “putting tools in the middle of the conversation”. Their widely adopted implementation of this is through Hubot. Hubot runs on Node.js offering a light-weight backend but also the extensibility that Node.js offers.</p>
<p>To gain the ChatOps benefits from Hubot you’ll want to run it somewhere that allows it access to internal resources. Ths way you can interact with your proprietary systems without exposing them to the internet. Should you find yourself in a place where you’re either comfortable connecting your VPC to your local network or simply don’t care about interacting with local resources this article is for you. Deploying Hubot to AWS Beanstalk is great because it has the scaling availability that Beanstalk offers coupled with the cheap pricing of EC2. Most hubot instances will easily fall within EC2’s free tier.</p>
<a id="more"></a>
<h2 id="Create-a-Hubot"><a href="#Create-a-Hubot" class="headerlink" title="Create a Hubot"></a>Create a Hubot</h2><p>Before we discuss deploying Hubot, let’s make sure you have an instance of Hubot ready to deploy. When you can run it locally and it successfully connects to the adapter of your choice, we’ll move on. Check out <a href="https://hubot.github.com/docs/#getting-started-with-hubot" target="_blank" rel="external">Getting Started With Hubot</a> and build your Hubot instance. Don’t worry, we’ll wait for you.</p>
<h2 id="Setup-AWS"><a href="#Setup-AWS" class="headerlink" title="Setup AWS"></a>Setup AWS</h2><p>We’ll be using the Elastic Beanstalk CLI to deploy. You can find the docs <a href="http://docs.aws.amazon.com/elasticbeanstalk/latest/dg/eb-cli3.html" target="_blank" rel="external">here</a>. Here’s the gist</p>
<ol>
<li><p>Ensure you have <code>pip</code> installed</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo apt-get install python-pip</div></pre></td></tr></table></figure>
</li>
<li><p>Install the AWS EB CLI</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo pip install awsebcli</div></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="Configure-Hubot-for-EB"><a href="#Configure-Hubot-for-EB" class="headerlink" title="Configure Hubot for EB"></a>Configure Hubot for EB</h2><p>EB by default will run <code>npm start</code> to kick off your node app. This makes it easy for us to pragmatically define our startup options. We can configure npm’s <code>start</code> script in the <code>package.json</code> file. Note that coffee-script isn’t in EB’s PATH by default, so we’ll call it directly before calling Hubot with its various options.<br><figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">"name"</span>: <span class="string">"hubot"</span>,</div><div class="line">  <span class="attr">"version"</span>: <span class="string">"1.0.0"</span>,</div><div class="line">  <span class="attr">"scripts"</span>: &#123;</div><div class="line">    <span class="attr">"start"</span>: <span class="string">"node node_modules/coffee-script/bin/coffee node_modules/hubot/bin/hubot --name hubot --adapter slack"</span></div><div class="line">  &#125;,</div><div class="line">  <span class="attr">"dependencies"</span>: &#123;</div><div class="line">    <span class="attr">"coffee-script"</span>: <span class="string">"1.9.0"</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>You can test this by running <code>npm start</code>. Be sure to set any environment variables</p>
<h2 id="Create-the-EB-Application"><a href="#Create-the-EB-Application" class="headerlink" title="Create the EB Application"></a>Create the EB Application</h2><p>Configure EB. If you have a VPC, select the region where it exists. Otherwise the default is sufficient.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">eb init</div><div class="line"></div><div class="line"><span class="comment"># Select a default region</span></div><div class="line"><span class="comment"># 1) us-east-1 : US East (N. Virginia)</span></div><div class="line"><span class="comment"># 2) us-west-1 : US West (N. California)</span></div><div class="line"><span class="comment"># 3) us-west-2 : US West (Oregon)</span></div><div class="line"><span class="comment"># 4) eu-west-1 : EU (Ireland)</span></div><div class="line"><span class="comment"># 5) eu-central-1 : EU (Frankfurt)</span></div><div class="line"><span class="comment"># 6) ap-southeast-1 : Asia Pacific (Singapore)</span></div><div class="line"><span class="comment"># 7) ap-southeast-2 : Asia Pacific (Sydney)</span></div><div class="line"><span class="comment"># 8) ap-northeast-1 : Asia Pacific (Tokyo)</span></div><div class="line"><span class="comment"># 9) sa-east-1 : South America (Sao Paulo)</span></div><div class="line"><span class="comment"># 10) cn-north-1 : China (Beijing)</span></div><div class="line"><span class="comment"># (default is 3): </span></div><div class="line">3</div></pre></td></tr></table></figure>
<p>If this is your first time using EB you’ll be prompted to enter your AWS credentials.. If you don’t have these you can generate them <a href="https://console.aws.amazon.com/iam/home#users" target="_blank" rel="external">here</a>. Ensure that the user you use has access to provision EC2 instances<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># You have not yet set up your credentials or your credentials are incorrect </span></div><div class="line"><span class="comment"># You must provide your credentials.</span></div><div class="line"><span class="comment"># (aws-access-id): </span></div><div class="line">&lt;your aws-access-id&gt;</div><div class="line"><span class="comment"># (aws-secret-key): </span></div><div class="line">&lt;your aws-secret-key&gt;</div></pre></td></tr></table></figure></p>
<p>Now we’ll create the app.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Enter Application Name</span></div><div class="line"><span class="comment"># (default is "Desktop"): </span></div><div class="line">hubot</div><div class="line"><span class="comment"># Application hubot has been created.</span></div></pre></td></tr></table></figure></p>
<p>Be sure to select the Node.js platform<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Select a platform.</span></div><div class="line"><span class="comment"># 1) Node.js</span></div><div class="line"><span class="comment"># 2) PHP</span></div><div class="line"><span class="comment"># 3) Python</span></div><div class="line"><span class="comment"># 4) Ruby</span></div><div class="line"><span class="comment"># 5) Tomcat</span></div><div class="line"><span class="comment"># 6) IIS</span></div><div class="line"><span class="comment"># 7) Docker</span></div><div class="line"><span class="comment"># 8) Multi-container Docker</span></div><div class="line"><span class="comment"># 9) GlassFish</span></div><div class="line"><span class="comment"># 10) Go</span></div><div class="line"><span class="comment"># 11) Java</span></div><div class="line"><span class="comment"># (default is 1):</span></div><div class="line">1</div></pre></td></tr></table></figure></p>
<p>For hubot, we don’t need to setup SSH<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Do you want to set up SSH for your instances?</span></div><div class="line"><span class="comment"># (y/n): </span></div><div class="line">n</div></pre></td></tr></table></figure></p>
<p>At this point you should be able to see the empty application provisioned on the <a href="https://console.aws.amazon.com/elasticbeanstalk/home" target="_blank" rel="external">Beanstalk Console</a>. Protip: make sure you’re viewing the region you previously chose. You can witch regions at the top right.</p>
<h1 id="Create-an-EB-Environment"><a href="#Create-an-EB-Environment" class="headerlink" title="Create an EB Environment"></a>Create an EB Environment</h1><p>Before we can deploy, we need to setup an environment to deploy to. We can create one with <code>eb create</code> or select an already existing environment with <code>eb use my-env-name</code><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">eb create</div><div class="line"><span class="comment"># Enter Environment Name</span></div><div class="line"><span class="comment"># (default is hubot-dev): </span></div><div class="line">production</div><div class="line"><span class="comment"># Enter DNS CNAME prefix</span></div><div class="line"><span class="comment"># (default is hubot-dev)</span></div><div class="line"><span class="comment"># Creating application version archive "app".</span></div><div class="line"><span class="comment"># Uploading hubot/app.zip to S3. This may take a while.</span></div><div class="line"><span class="comment"># Upload Complete.</span></div></pre></td></tr></table></figure></p>
<p>Hubot configuration is pulled from environment variables. To set environment variables for your EB Environment we’ll use <code>eb setenv</code><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">eb setenv HUBOT_SLACK_TOKEN=xxxxx</div><div class="line"><span class="comment"># INFO: Environment update is starting.                               </span></div><div class="line"><span class="comment"># INFO: Updating environment demo-production's configuration settings.</span></div></pre></td></tr></table></figure></p>
<h1 id="Deploy"><a href="#Deploy" class="headerlink" title="Deploy"></a>Deploy</h1><p>Finally, we can deploy this beast.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">eb deploy</div></pre></td></tr></table></figure></p>
<p>Be sure to check out the status of your instance in the <a href="https://console.aws.amazon.com/elasticbeanstalk/home" target="_blank" rel="external">Beanstalk Console</a>. Once the application is fully deployed you can view its status and logs from the console or using the EB CLI.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://blog.milesmaddox.com/2015/10/13/Deploying-Hubot-to-AWS-Elastic-Beanstalk/" data-id="ciuzmhq6j0006pqqdyepofgs7" class="article-share-link">Share</a>
      
        <a href="http://blog.milesmaddox.com/2015/10/13/Deploying-Hubot-to-AWS-Elastic-Beanstalk/#disqus_thread" class="article-comment-link">Comments</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2015/10/25/chrome-extension-example/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Chrome Extension Example
        
      </div>
    </a>
  
  
    <a href="/2015/10/08/install-scripts/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Collection of Install Scripts</div>
    </a>
  
</nav>

  
</article>


<section id="comments">
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>
</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2016/10/31/Docker_Shutdown_Hooks/">Docker Shutdown Hooks</a>
          </li>
        
          <li>
            <a href="/2015/10/25/Clone-A-Hard-Drive-Using-DD/">Clone a Hard Drive Using DD</a>
          </li>
        
          <li>
            <a href="/2015/10/25/chrome-extension-example/">Chrome Extension Example</a>
          </li>
        
          <li>
            <a href="/2015/10/13/Deploying-Hubot-to-AWS-Elastic-Beanstalk/">Deploying Hubot to AWS Elastic Beanstalk</a>
          </li>
        
          <li>
            <a href="/2015/10/08/install-scripts/">Collection of Install Scripts</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/devops/">devops</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/software/">software</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/uncategorized/">uncategorized</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/walkthrough/">walkthrough</a><span class="category-list-count">4</span></li></ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2016 Miles Maddox<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">home</a>
  
</nav>
    
<script>
  var disqus_shortname = 'milesmaddox';
  
  var disqus_url = 'http://blog.milesmaddox.com/2015/10/13/Deploying-Hubot-to-AWS-Elastic-Beanstalk/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>